import{d as S,r as d,w as N,g as R,a as $,b as V,u as C,e as z,f as h,c as n,o as s,n as L,h as p,i as y,j,k as x,S as P,t as f,l as B,m as U,p as q,q as b,s as A,v as E,F as G,x as K}from"./index-BJQfm-jm.js";const W={key:0},Y={class:"text-reader"},Z=["disabled"],I={key:0},J={key:1},M=S({__name:"ToolBarReadFile",props:{dep:{}},setup(w){const i=w;d(!0);async function v(){a.value=!1,await U(i.dep||"activePlugin"),a.value=!0}const u=d(""),_=d(null),a=d(!0),r=d(!1);N(a,async t=>{if(t===!0)try{const e=await R(i.dep||"activePlugin");r.value=!!e}catch(e){console.error(e)}else r.value=!1},{immediate:!0});function F(t,e=2){if(!+t)return"0 Bytes";const l=1024,g=e<0?0:e,m=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],c=Math.floor(Math.log(t)/Math.log(l));return`${parseFloat((t/Math.pow(l,c)).toFixed(g))} ${m[c]}`}$(async()=>{await V()});const k=C(),o=d(""),H=z();async function T(t){try{o.value="0%",a.value=!1;const e=t.target;if(!e.files)return;const l=e.files;if(!l.length)return;_.value=F(l[0].size),o.value="10%",u.value=l[0].name;const g=await l[0].arrayBuffer();o.value="80%";const m=new Uint8Array(g);o.value="85%";const c=await q(m);if(o.value="90%",i.dep)await b(c,i.dep,!1);else{await b(c,u.value,!0),o.value="98%";const D=await A();k.setPluginHeader(D)}H.triggerReload(),o.value=""}catch(e){console.error(e)}finally{a.value=!0}}return h(()=>k.getPluginHeader?.TMP_dep||""),(t,e)=>(s(),n("div",{class:L(["text-reader__wrapper",{"text-reader__wrapper_dep":t.dep}])},[p("button",{class:"text-reader",onClick:v},[a.value?(s(),n("span",W,"Delete")):(s(),j(x(P),{key:1}))]),p("label",Y,[p("input",{type:"file",accept:".esp,.esm",onChange:T,disabled:!a.value},null,40,Z),a.value?(s(),n("span",I,f(r.value?"Change":"Load"),1)):(s(),n("span",J,[y(f(o.value),1),B(x(P))]))]),y(" "+f(r.value?"Loaded":"Not loaded"),1)],2))}}),O={class:"frame-upload"},Q={class:"frame-upload-deps"},X={key:0,class:"frame-upload-deps__title"},ae=S({__name:"ModalContentUpload",setup(w){const i=C(),v=h(()=>i.getPluginHeader),u=h(()=>v.value?.masters?.map(_=>_[0])||[]);return(_,a)=>(s(),n("div",O,[a[0]||(a[0]=p("h2",{class:"modal__title"},"Upload your plugin and its masters",-1)),B(M),p("div",Q,[u.value&&u.value.length>0?(s(),n("div",X," Requires: ")):E("",!0),(s(!0),n(G,null,K(u.value,r=>(s(),n("div",{class:"frame-upload-deps__element",key:r},[y(f(r)+" ",1),B(M,{dep:r},null,8,["dep"])]))),128))])]))}});export{ae as default};
