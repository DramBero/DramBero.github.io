import{_ as v,c as i,o as n,i as l,x as u,j as _,t as a,k as g,y as T,h as c,F as r,v as p,T as h,z as f,A as N,n as C,B as S}from"./index-BduKppn6.js";function I(o,t){var m=null;return function(){clearTimeout(m);var k=arguments,e=this;m=setTimeout(function(){o.apply(e,k)},t)}}const b={data(){return{nameError:"",idError:"",inputName:"",inputTopic:"",speakerName:"",speakerId:"",foundNPCs:[],dialogueType:"Topic",speakerSelectedType:{typeName:"NPC/Creature",typeId:"speaker_id"},dialogueSelectedType:{typeName:"Topic",typeId:"Topic"},speakerTypes:[{typeName:"NPC/Creature",typeId:"speaker_id"},{typeName:"Cell",typeId:"speaker_cell"},{typeName:"Faction",typeId:"speaker_faction"},{typeName:"Class",typeId:"speaker_class"},{typeName:"Race",typeId:"speaker_race"},{typeName:"Global",typeId:""}],dialogueTypes:[{typeName:"Topic",typeId:"Topic"},{typeName:"Greeting",typeId:"Greeting"},{typeName:"Persuasion",typeId:"Persuasion"}],greetings:["Greeting 0","Greeting 1","Greeting 2","Greeting 3","Greeting 4","Greeting 5","Greeting 6","Greeting 7","Greeting 8","Greeting 9"],persuasions:["Bribe Fail","Bribe Success","Admire Fail","Admire Success","Intimidate Fail","Intimidate Success","Taunt Fail","Taunt Success","Info Refusal","Service Refusal"],speakerSelect:!1}},watch:{inputName:{handler:I(function(){this.searchNPCs()},200)},inputTopic(){}},methods:{async searchNPCs(){if(!this.inputName||this.inputName.length<3){this.foundNPCs=[];return}const o=await S(this.inputName);this.foundNPCs=o},createTopic(){if(this.inputTopic){console.log("SPEAKER_TYPE: ",this.speakerSelectedType.typeId);let o=this.$store.getters.getBestOrderLocationForNpc([this.speakerId,this.inputTopic,this.dialogueSelectedType.typeId,this.speakerSelectedType.typeId]);console.log(o[2]),this.$store.commit("addDialogue",[this.speakerSelectedType.typeId,this.speakerId||this.speakerName,this.inputTopic,this.dialogueSelectedType.typeId,o[0],"next","New entry"]),this.$store.commit("setPrimaryModal",""),this.$store.commit("setDialogueModal",this.speakerId)}else return}},computed:{getTopics(){return this.inputTopic?this.$store.getters.searchTopics(this.inputTopic):[]},getSpeakersByType(){switch(this.speakerSelectedType.typeId){case"speaker_id":return[];case"speaker_cell":return this.$store.getters.getCellList.filter(o=>o&&o.toUpperCase().includes(this.inputName.toUpperCase()));case"speaker_race":return this.$store.getters.getRaceList.filter(o=>o&&o.toUpperCase().includes(this.inputName.toUpperCase()));case"speaker_class":return this.$store.getters.getClassList.filter(o=>o&&o.toUpperCase().includes(this.inputName.toUpperCase()));case"speaker_faction":return this.$store.getters.getFactionList.filter(o=>o&&o.toUpperCase().includes(this.inputName.toUpperCase()));default:return[]}}}},G={class:"frame-upload"},P={key:0},w={class:"add-dialogue-label"},F={key:0,class:"add-dialogue-label-select-items"},x=["onClick"],B={class:"modal-field"},U=["placeholder"],E={key:0,class:"found-names"},L=["onClick"],A={class:"found-names-name__title"},M={class:"found-names-name__id"},D={key:1,class:"found-names"},V=["onClick"],R={key:1},z={class:"add-dialogue-label"},j={key:0,class:"add-dialogue-label-select-items"},q=["onClick"],K={class:"speaker-name"},O={class:"topic-create-controls"},Y={key:0,class:"modal-field"},H=["placeholder"],J=["disabled"],Q={key:0,class:"found-names"},W=["onClick"],X={key:1,class:"found-names"},Z=["onClick"],$={key:2,class:"found-names"},ee=["onClick"];function se(o,t,m,k,e,y){return n(),i("div",null,[l("div",G,[t[11]||(t[11]=l("h2",{class:"modal__title"},"Create a new dialogue",-1)),l("form",{class:"add-dialogue-form",onSubmit:t[7]||(t[7]=u(s=>y.createTopic(),["prevent"]))},[!e.speakerName&&e.speakerSelectedType.typeName!=="Global"?(n(),i("div",P,[l("div",w,[_(" Choose "+a(e.speakerSelectedType.typeId==="speaker_id"?"an":"a")+" ",1),l("span",{class:"add-dialogue-label-select",tabindex:"0",onFocusout:t[1]||(t[1]=s=>e.speakerSelect=!1)},[l("span",{class:"speaker-change",onClick:t[0]||(t[0]=s=>e.speakerSelect=!e.speakerSelect)},a(e.speakerSelectedType.typeName),1),g(h,{name:"fadeAppear"},{default:T(()=>[e.speakerSelect?(n(),i("div",F,[(n(!0),i(r,null,p(e.speakerTypes,s=>(n(),i("div",{class:"add-dialogue-label-select-items__item",key:s,onClick:d=>(e.speakerSelectedType=s,e.speakerSelect=!1)},a(s.typeName),9,x))),128))])):c("",!0)]),_:1}),t[8]||(t[8]=_(" : ",-1))],32)]),l("label",B,[e.nameError?(n(),i("span",{class:"error",key:o.index},a(e.nameError),1)):c("",!0),f(l("input",{class:"modal-field__input",name:"speaker-name",autocomplete:"off",placeholder:`Type ${e.speakerSelectedType.typeName} name`,"onUpdate:modelValue":t[2]||(t[2]=s=>e.inputName=s)},null,8,U),[[N,e.inputName]])]),e.speakerSelectedType.typeId==="speaker_id"?(n(),i("div",E,[(n(!0),i(r,null,p(e.foundNPCs,s=>(n(),i("div",{class:C(["found-names-name",{"found-names-name_active":!s.TMP_dep}]),key:s.id,onClick:d=>{e.speakerId=s.id,e.speakerName=s.name}},[l("div",A,a(s.name),1),l("div",M,a(s.id),1)],10,L))),128))])):(n(),i("div",D,[(n(!0),i(r,null,p(y.getSpeakersByType,s=>(n(),i("div",{class:"found-names-name",key:s.toString(),onClick:d=>(e.speakerName=s,e.speakerId="")},a(s),9,V))),128))]))])):(n(),i("div",R,[l("div",z,[t[9]||(t[9]=l("span",null,"Add ",-1)),l("span",{class:"add-dialogue-label-select",tabindex:"0",onFocusout:t[4]||(t[4]=s=>e.speakerSelect=!1)},[l("span",{class:"speaker-change",onClick:t[3]||(t[3]=s=>e.speakerSelect=!e.speakerSelect)},a(e.dialogueSelectedType.typeName.toLowerCase()),1),g(h,{name:"fadeAppear"},{default:T(()=>[e.speakerSelect?(n(),i("div",j,[(n(!0),i(r,null,p(e.dialogueTypes,s=>(n(),i("div",{class:"add-dialogue-label-select-items__item",key:s,onClick:d=>(e.dialogueSelectedType=s,e.speakerSelect=!1)},a(s.typeName),9,q))),128))])):c("",!0)]),_:1})],32),t[10]||(t[10]=l("span",null," to: ",-1)),l("span",K,a(e.speakerSelectedType.typeName==="Global"?"Global":e.speakerName)+".",1),l("a",{class:"speaker-change",onClick:t[5]||(t[5]=s=>{e.speakerId="",e.speakerName=""})},a(" Change?"))]),l("div",O,[e.dialogueSelectedType.typeId==="Topic"?(n(),i("label",Y,[f(l("input",{class:"modal-field__input",name:"dialogue-topic",placeholder:`Type ${e.dialogueSelectedType.typeId==="Topic"?"the":"a"} ${e.dialogueSelectedType.typeName.toLowerCase()}`,autocomplete:"off",required:"","onUpdate:modelValue":t[6]||(t[6]=s=>e.inputTopic=s)},null,8,H),[[N,e.inputTopic]])])):c("",!0),l("button",{type:"submit",class:"modal-button",disabled:!e.inputTopic},"Create",8,J)]),e.dialogueSelectedType.typeId==="Topic"?(n(),i("div",Q,[(n(!0),i(r,null,p(y.getTopics,s=>(n(),i("div",{class:C(["found-names-name",{"found-names-name_active":!s[0].TMP_dep}]),key:s.id,onClick:u(d=>e.inputTopic=s[0].id,["prevent"])},a(s[0].id),11,W))),128))])):e.dialogueSelectedType.typeId==="Greeting"?(n(),i("div",X,[(n(!0),i(r,null,p(e.greetings,s=>(n(),i("div",{class:"found-names-name",key:s,onClick:u(d=>e.inputTopic=s,["prevent"])},a(s),9,Z))),128))])):e.dialogueSelectedType.typeId==="Persuasion"?(n(),i("div",$,[(n(!0),i(r,null,p(e.persuasions,s=>(n(),i("div",{class:"found-names-name",key:s,onClick:u(d=>e.inputTopic=s,["prevent"])},a(s),9,ee))),128))])):c("",!0)]))],32)])])}const ie=v(b,[["render",se]]);export{ie as default};
